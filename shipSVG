Ship_Unflood :=
VAR Actual    = [Actual Count]         -- your measure
VAR Required  = [Required Count]       -- your measure
VAR Deficit   = MAX ( Required - Actual, 0 )
VAR pct_def   = DIVIDE ( Deficit, Required, 0 )          -- % shortfall
VAR W         = 2095
VAR H         = 2095
VAR FloodH    = INT ( H * pct_def )
VAR FloodY    = H - FloodH

-- converted ship paths (without the background rect)
VAR ShipPaths = "
<path d='M1204.578125 932.171875C1204.578125 933.898438 1204.578125 935.628906 1204.578125 937.359375L1197.769531 937.359375L1197.320312 936.359375C1199.738281 934.960938 1202.160156 933.570312 1204.578125 932.171875Z' fill='#888'/>
<path d='M868.039062 1012.621094C870.457031 1014.019531 872.878906 1015.421875 875.300781 1016.820312L875.296875 1016.820312L874.847656 1017.820312L868.039062 1017.820312C868.039062 1016.089844 868.039062 1014.359375 868.039062 1012.621094Z' fill='#888'/>
<path d='M1678.949219 1080.210938C1678.949219 1081.949219 1678.949219 1083.679688 1678.949219 1085.410156L1672.140625 1085.410156L1671.691406 1084.410156C1674.109375 1083.011719 1676.53125 1081.609375 1678.949219 1080.210938Z' fill='#888'/>
<path d='M1039.429688 854.089844L1039.429688 993.289062L997.066406 1031.789062L919.171875 1031.789062L910.246094 1015.019531C909.9 1014.2 909.2 1013.7 908.4 1013.2L896.3 1011L832.2 982.6L822 978L812.3 970.9L809.2 974.6L819.1 981.3L851.9 1000L863.9 1007.6L869.8 1027.2L850.6 1058.4L735.8 996.9L734.3 906.7L730.5 906.7L730.5 996.8L664.6 995.5L664.6 906.7L660.8 906.7L660.8 995.4L652.5 995.2L648.3 1053.2L639.3 1039.6L614.7 1037.9L605.5 1044.9L589.6 1047.1L566.1 1047L566.1 1050L601.7 1050.6L600.8 1054.3L564.2 1121.4L513.1 1121.4L516.7 1088.8L488 1104.4L442.9 1100.7L406 1102.6L382.4 1106.6C380.7 1107.4 379.6 1108.2 379.1 1109.5C378.9 1111.3 379.5 1112.6 381.1 1113.3C382.8 1114.3 386 1115.1 390.6 1115.7L417.4 1119.1L431.5 1120.6C430.1 1121.4 428.7 1121.8 427.7 1121.4L319.1 1121.4L323.1 1111.6L294.0 1104.4L248.9 1100.7L212.1 1102.3L188.5 1106.6C186.7 1107.4 185.7 1108.2 185.2 1109.5C184.9 1111.3 185.6 1112.6 187.1 1113.3C188.8 1114.3 192 1115.1 196.6 1115.7L223.5 1119.1L237.5 1120.6C236.2 1121.4 234.8 1121.8 233.8 1121.4L80.5 1121.4L155.7 1240.2L1881.1 1240.2L2013.8 1121.4L1798.4 1098.8L1766.4 1083.2L1756.4 1098.8L1611.6 1098.8L1586 1056.9L1550.9 1057.9L1540.3 1039.8L1518.3 1039.8Z' fill='#888'/>
"

VAR FloodBlue = "#1e88e5"

RETURN
"data:image/svg+xml;utf8," &
"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 " & W & " " & H & "' width='" & W & "' height='" & H & "'>" &
"  <defs><clipPath id='shipClip'>" & ShipPaths & "</clipPath></defs>" &
-- Draw ship grey
"  <g>" & ShipPaths & "</g>" &
-- Water deficit fill
"  <g clip-path='url(#shipClip)'>" &
"    <rect x='0' y='" & FloodY & "' width='" & W & "' height='" & FloodH & "' fill='" & FloodBlue & "' fill-opacity='0.6'/>" &
"  </g>" &
-- Label
"  <text x='" & W/2 & "' y='180' text-anchor='middle' font-family='Segoe UI' font-size='140' fill='#333'>" &
       FORMAT(Actual,"#,0") & " / " & FORMAT(Required,"#,0") &
"  </text>" &
"</svg>"